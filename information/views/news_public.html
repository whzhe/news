<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Bootstrap 101 Template</title>
	</head>
	<style>
		* {
			padding: 0;
			margin: 0;
		}
		
		body {
			/*background: url(img/nesbg.jpg);
			background-size: auto;*/
			background: rgba(0, 0, 0, 0.05);
		}
		
		.active {
			background: red;
		}
		
		#header {
			height: 50px;
			position: relative;
			background: white;
		}
		
		#header .bigtitle {
			font-size: 25px;
			color: darkslategray;
			position: absolute;
			left: 200px;
			line-height: 50px;
		}
		
		.login {
			text-decoration: none;
			position: absolute;
			right: 100px;
			line-height: 50px;
		}
		
		.nav {
			border-top: 3px solid red;
			border-bottom: 1px solid gainsboro;
			width: 100%;
			min-width: 1200px;
			/*background: white;*/
			margin-bottom: 10px;
		}
		
		#siteNavPart1 {
			/*border: 1px solid blue;*/
			height: 40px;
			width: 1200px;
			margin: 0 auto;
			text-align: center;
		}
		
		#siteNavPart1 li {
			/*			float: left;*/
			width: 72px;
			text-align: center;
			margin: 0 0 0 -1px;
			padding: 0;
			list-style: none;
			font-size: 16px;
			display: inline-block
		}
		
		#siteNavPart1 li a {
			color: #252525;
			display: block;
			text-decoration: none;
			width: 72px;
			padding: 8px 0;
		}
		
		#siteNavPart1 li a:hover {
			background: red;
		}
		
		.allContainer {
			/*border: 1px solid orange;*/
			width: 1200px;
			position: relative;
			margin: 0 auto;
			/*background: white;*/
			height: 770px;
			box-shadow: 0 0 2px rgba(0, 0, 0, .2);
		}
		
		#container {
			border: 1px solid gainsboro;
			width: 500px;
			overflow: auto;
			background: white;
			height: 745px;
			position: relative;
			padding-top: 25px;
			cursor: pointer;
			position: absolute;
			top: 0;
			left: 0;
			text-align: center;
			border-right: 2px solid dodgerblue;
		}
		
		.unfold {
			height: 25px;
			line-height: 25px;
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			/*background: red;*/
			text-align: right;
			border-bottom: 1px solid gainsboro;
			background: white;
		}
		
		.unfoldBtn {
			font-size: 16px;
			position: absolute;
			left: -27px;
			background: white;
			border: 1px solid gainsboro;
			top: 2px;
			z-index: 20;
			color: orange;
		}
		
		.cell {
			border: 1px solid gainsboro;
			padding: 5px;
			width: 480px;
			display: inline-block;
			margin-top: 2px;
			text-align: left;
			background: white;
		}
		
		.cell .title {
			font-size: 16px;
		}
		
		.cell .digest {
			color: gray;
		}
		
		.cell .origin {
			color: blue;
			text-decoration: none;
		}
		
		.myframecon {
			border: 1px solid gainsboro;
			height: 100%;
			width: 690px;
			position: absolute;
			top: 0;
			right: 0;
			text-align: center;
			border-right: 2px solid dodgerblue;
			/*overflow: auto;*/
			/*background: white;*/
		}
		
		.myframe {
			/*border: 1px solid black;*/
			border: none;
			height: 98%;
			width: 98%;
			/*position: absolute;
			top: 0;
			right: 0;*/
			overflow: auto;
			display: inline-block;
			margin-top: 1%;
			/*background: white;*/
		}
		
		.unfold2 {
			position: absolute;
			right: -20px;
			top: 2px;
			height: 25px;
			line-height: 25px;
			border-bottom: 1px solid gainsboro;
			color: orange;
			cursor: pointer;
			border: 1px solid gainsboro;
			background: white;
		}
		
		.bottom {
			height: 50px;
			border-top: 1px solid gainsboro;
			text-align: center;
			background: white;
			margin-top: 5px;
		}
		
		.copyright {
			height: 50px;
			line-height: 50px;
			color: darkgray;
		}
	</style>

	<body>
		<div id="app">
			<div id="header">
				<div class="bigtitle">新闻</div>
				<a class="login" href="login.html">登陆</a>

			</div>

			<div class="nav">
				<ul id="siteNavPart1">
					<li class="active" category="sports">
						<a>体育</a>
					</li>
					<li category="politics">
						<a>政治</a>
					</li>
					<li category="finance">
						<a>财经</a>
					</li>
					<!--<li>
						<a>体育</a>
					</li>
					<li>
						<a>娱乐</a>
					</li>
					<li>
						<a>科技</a>
					</li>-->
				</ul>
			</div>

			<div class="allContainer">

				<div class="unfoldBtn">展开</div>

				<div id="container">

					<div class="cell" v-for="dic in news">
						<div class="title">{{dic.title}}</div>
						<div class="digest">{{dic.content}}</div>
						<a class="origin" v-bind:url="dic.oriUrl" onclick="openUrl(this)">访问原网页</a>
					</div>

				</div>
				<div class="myframecon">
					<iframe class="myframe" src="https://www.baidu.com/home/news/data/newspage?nid=3223333526973792998&n_type=0&p_from=1&dtype=-1">
			</iframe>
					<div class="unfold2">展开</div>
				</div>

			</div>
			<div class="bottom">
				<div class="copyright">copyright 2017</div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="js/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="js/vue.js"></script>
	<script>
		var startIndex = 0;
		var num = 30;
		var canLoad = true;
		
		
		var app = new Vue({
			el: '#app',
			data: {
				news: []
			}
		});

		//获取类别

		function getcategory() {
			category = $(".nav").find("[class=active]").find("a").text();
			$("#siteNavPart1 li").on("click", function() {
				$(this).addClass("active").siblings().removeClass("active");
				category = $(this).attr("category");

				//刷新数据
				startIndex = 0;
				canLoad = true;
				app.news = [];
				getData(startIndex, num);
			});
		}
		getcategory();

		function successCallback() {
			var data = {
				type: "MSG_TYPE_NEWS_GET_NEWS",
				ret: 0, // 非0 时，携带errStr字段，不携带data
				data: [{ //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标题1", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}, { //第一条新闻

						category: "sports", //类别: sports,finance,politics
						title: "新闻的标2", // 标题
						content: "这是摘要的内容2", //正文（摘要的内容）
						source: "sina", //来源：toutiao,sina,sohu
						oriUrl: "http://www.baidu.com", //原始链接
						newsTime: "2017-09-01", //新闻写作时间；另外在数据库中创建该新闻时，需要加一个创建时间字段
						audioFile: "audio/20170901/sports/sport_0000001", //语音文件的文件名. 0000001建议为数据库的id字段
						voiceType: ["male", "female", "lingzhiling"], //后台合成几个，放几个，至少合成male与female
						audoFileSuffix: ".mp3", // 实际使用中文件名为 [audioFile]_[voiceType].[audoFileSuffix]
						imageFile: ["img/20170901/sports/sport_0000001_0.jpg", "img/20170901/sports/sport_0000001_1.jpg"] //新闻配图文件地址
					}

				]
			};

			app.news = data.data;

		} //originata
		successCallback();

		//请求数据

		function getData(startIdx, num) {
			if(!canLoad) return;

			canLoad = false;
			var url = "/news";
			var param = {
				type: "MSG_TYPE_NEWS_GET_NEWS",
				category: category,
				startIdx: startIdx,
				num: num
			};
			$.ajax({
				type: "post",
				url: url,
				timeout: 3000, //3s
				async: true, //异步
				data: param,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function(data) {
					for(var i = 0; i < data.data.length; i++) {
						app.news.push(data.data[i]);
					}
					if(data.data.length < 30) { //已经全部加载完毕
						startIndex = startIndex + data.data.length;
						return;
					}
					canLoad = true;
					startIndex = startIndex + num;
				},
				error: function() {
					canLoad = true;
				}
			});

		} //getData

		getData(startIndex, num);

		var divscroll = document.getElementById('container');

		//滚动到底部刷新
		function divScroll() {
			var wholeHeight = divscroll.scrollHeight;
			var scrollTop = divscroll.scrollTop;
			var divHeight = divscroll.clientHeight;
			if(scrollTop + divHeight >= wholeHeight) {
				getData(startIndex, num);
			}
			//			if(scrollTop == 0) {
			//				alert('滚动到头部了！');
			//			}
		}
		divscroll.onscroll = divScroll;

		$(".unfoldBtn").on("click", function() {

			$(".myframecon").toggle();

			if($(this).text() == "展开") {
				$(this).text("收起");
				$(this).siblings("#container").css({
					"width": "100%"
				});
			} else {
				$(this).text("展开");
				$(this).siblings("#container").css({
					"width": "500px"
				});
			}

		});
		$(".unfold2").on("click", function() {

			$("#container").toggle();

			if($(this).text() == "展开") {
				$(this).text("收起");
				$(this).parent(".myframecon").css({
					"width": "100%"
				});
			} else {
				$(this).text("展开");
				$(this).parent(".myframecon").css({
					"width": "690px"
				});

			}

		});

		function openUrl(athis) {

			var thisurl = $(athis).attr("url");
			$(".myframe").attr({
				"src": thisurl
			});
		}
	</script>

</html>